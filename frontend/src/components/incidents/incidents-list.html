<section>
  <h4 class="sn-uppertitle">{{ ::$ctrl.viewStrings.title }}</h4>
  <div class="sn-card" auto-resizer>
    <header class="sn-card__header">
      <h5 class="header__title">{{ ::$ctrl.viewStrings.tableTitle }}</h5>
    </header>
    <div class="row stack-m">
      <div class="col-xs-3" style="padding-top: 16px;">
        <sn-date-picker
          label="{{::$ctrl.viewStrings.startDate}}"
          on-change="$ctrl.setFilter({ key: 'startDate', value: $event.value})"
          current-date="$ctrl.setStartDate()"
        ></sn-date-picker>
      </div>
      <div class="col-xs-3" style="padding-top: 16px;">
        <sn-date-picker
          label="{{::$ctrl.viewStrings.endDate}}"
          on-change="$ctrl.setFilter({ key: 'endDate', value: $event.value})"
        ></sn-date-picker>
      </div>
      <div class="col-xs-2 col-xs-offset-4">
        <sn-select
          label="'Status'"
          selected="$ctrl.viewStrings.status[0].value"
          options="$ctrl.viewStrings.status"
          on-change="$ctrl.setFilter({ key: 'status', value: $event.value })"
        ></sn-select>  
      </div>
    </div>
    <s-table
      items="$ctrl.items"
      headers="$ctrl.tableHeaders"
      loading="$ctrl.isLoading"
    ></s-table>
    <div style="text-align: right; margin-top: 16px;" ng-if="$ctrl.items.length">
      <button class="{{$ctrl.styles['prev-button']}}" ng-click="$ctrl.changePage(-1)"></button>
      <button class="{{$ctrl.styles['next-button']}}" ng-click="$ctrl.changePage(1)"></button>
      <span class="sn-table__footer">
        Showing {{$ctrl.paging.min}} to {{$ctrl.paging.max}} of {{$ctrl.pagination.total}}
      </span>
    </div>
  </div>

  <div
    sn-modal
    open="$ctrl.modalOpen"
    title="$ctrl.viewStrings.modalTitle"
  >
    <article class="{{::$ctrl.styles.scroller}}">
      <div
        ng-repeat="(key, val) in $ctrl.modalEntries"
        class="{{::$ctrl.styles['event-entry']}}"
      >
        <span class="{{::$ctrl.styles['event-entry__title']}}">{{ val }}</span>
        <span>{{ $ctrl.incident[key] }}</span>
      </div>
      <h5 class="{{::$ctrl.styles['modal-title']}}">{{::$ctrl.viewStrings.modalSubtitle}}</h5>
      <div class="{{::$ctrl.styles.xmlviewer}}">
          {{$ctrl.incident.recommendation}}
        </div>
    </article>
    <footer class="{{::$ctrl.styles.footer}}">
      <button
        class="{{::$ctrl.styles.button}}"
        ng-click="$ctrl.toggleIncidentModal()"
      >{{::$ctrl.viewStrings.close}}</button>
      <button
        ng-if="$ctrl.incident.status && $ctrl.incident.status !== 'Applied'"
        class="{{::$ctrl.styles.button}}"
        ng-click="$ctrl.applyRecommendation()"
      >{{::$ctrl.viewStrings.apply}}</button>
    </footer>
  </div>
</section>